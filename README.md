# InventorySync - Advanced Shopify Inventory Management

A sophisticated inventory management system for Shopify stores with real-time synchronization, multi-location support, custom fields, and advanced analytics. Built with FastAPI and React for optimal performance and user experience.

## üìã Table of Contents
- [Current Status](#-current-status)
- [Features](#-features)
- [Tech Stack](#-tech-stack)
- [Installation](#-installation)
- [PostgreSQL Database Setup](#-postgresql-database-setup)
- [Authentication Configuration](#-authentication-configuration)
- [Custom Fields API](#-custom-fields-api)
- [Project Structure](#-project-structure)
- [Troubleshooting](#-troubleshooting)
- [API Documentation](#-api-documentation)
- [Testing](#-testing)
- [Deployment](#-deployment)
- [Contributing](#-contributing)

## üöÄ Current Status

**Development Environment**: ‚úÖ Running Successfully
- Backend API: http://localhost:8000
- Frontend App: http://localhost:3000
- Database: PostgreSQL/SQLite (configurable)
- API Documentation: http://localhost:8000/docs
- Monitoring Dashboard: http://localhost:3001

**Recent Updates**:
- ‚úÖ Fixed authentication flow for development environment
- ‚úÖ Implemented auto-authentication for local development
- ‚úÖ Resolved shop domain resolution issues
- ‚úÖ Added custom fields API with industry templates
- ‚úÖ Database schema optimizations

See [PROJECT_STATUS.md](PROJECT_STATUS.md) for detailed status and next steps.

## ‚ú® Features

### Core Functionality
- üì¶ **Real-time Inventory Sync** - Bidirectional synchronization with Shopify
- üè™ **Multi-location Support** - Manage inventory across unlimited locations
- üìä **Advanced Analytics Dashboard** - Real-time insights and KPIs
- üîî **Smart Alert System** - Customizable notifications and thresholds
- üè∑Ô∏è **Custom Fields Manager** - Flexible product metadata with templates
- üîÑ **Bulk Operations** - Efficient mass updates with progress tracking
- üìà **AI-Powered Forecasting** - Machine learning demand prediction
- üõ°Ô∏è **Enterprise Security** - JWT authentication, RBAC, audit logs
- üîß **Workflow Automation** - Rule-based triggers and actions
- üí≥ **Shopify Billing Integration** - Subscription management via Shopify API

## Tech Stack

### Backend
- **FastAPI** - High-performance Python web framework
- **PostgreSQL** - Primary database with JSONB for custom fields
- **SQLAlchemy** - ORM with async support
- **Redis** - Caching and session management
- **Alembic** - Database migrations
- **JWT** - Secure authentication
- **Prometheus** - Metrics and monitoring
- **Grafana** - Visualization and alerting
- **Sentry** - Error tracking and performance monitoring

### Frontend  
- **React 18** - Modern UI framework
- **Shopify Polaris** - Native Shopify design system
- **Vite** - Lightning-fast build tool
- **React Router** - Client-side routing
- **Axios** - HTTP client with interceptors

## üì¶ Installation

### Prerequisites

- Python 3.10+ with pip
- Node.js 18+ with npm
- PostgreSQL 13+ (or use SQLite for development)
- Redis 6+ (optional for caching)
- Git for version control

### Detailed Installation Steps

#### 1. Clone the Repository
```bash
git clone https://github.com/yourusername/inventorysync-shopify-app.git
cd inventorysync-shopify-app
```

#### 2. Backend Setup

```bash
# Navigate to backend directory
cd backend

# Create virtual environment
python -m venv venv

# Activate virtual environment
# On Linux/macOS:
source venv/bin/activate
# On Windows:
venv\Scripts\activate

# Upgrade pip
pip install --upgrade pip

# Install dependencies
pip install -r requirements.txt
```

#### 3. Environment Configuration

```bash
# Copy environment template
cp .env.example .env

# Edit .env file with your settings
# For development, the defaults should work
```

#### 4. Frontend Setup

```bash
# Navigate to frontend directory
cd ../frontend

# Install dependencies
npm install

# Create development environment file
cp .env.example .env
```

#### 5. Initialize Development Database

```bash
# Navigate back to backend
cd ../backend

# Run database migrations
alembic upgrade head

# Create test data (optional)
python scripts/init_dev_data.py
```

## üóÑÔ∏è PostgreSQL Database Setup

### Option 1: PostgreSQL (Recommended for Production)

#### Install PostgreSQL

**Ubuntu/Debian:**
```bash
sudo apt update
sudo apt install postgresql postgresql-contrib
```

**macOS:**
```bash
brew install postgresql
brew services start postgresql
```

**Windows:**
Download installer from [PostgreSQL official site](https://www.postgresql.org/download/windows/)

#### Create Database and User

```bash
# Connect to PostgreSQL
sudo -u postgres psql

# Create database
CREATE DATABASE inventorysync_dev;

# Create user with password
CREATE USER inventorysync WITH ENCRYPTED PASSWORD 'devpassword123';

# Grant privileges
GRANT ALL PRIVILEGES ON DATABASE inventorysync_dev TO inventorysync;

# Enable extensions
\c inventorysync_dev
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

# Exit PostgreSQL
\q
```

#### Update .env File

```env
# backend/.env
DATABASE_URL=postgresql://inventorysync:devpassword123@localhost:5432/inventorysync_dev
DATABASE_URL_ASYNC=postgresql+asyncpg://inventorysync:devpassword123@localhost:5432/inventorysync_dev
```

### Option 2: SQLite (Development Only)

For quick development setup, SQLite is used by default:

```env
# backend/.env
DATABASE_URL=sqlite:///./inventorysync_dev.db
```

No additional setup required - the database file will be created automatically.

## üîç Monitoring and Logging

### Monitoring Setup
- **Prometheus** is integrated for comprehensive metrics collection.
- **Grafana** dashboards provide visual insights and alerting.
- **Sentry** is configured for error tracking and performance monitoring.

### Logging Setup
- Structured logging with request ID tracing and various log levels.

## üöÄ Quick Start Guide

### Start Development Environment

1. **Using the convenience script (Recommended)**:
   ```bash
   # Make scripts executable
   chmod +x scripts/*.sh
   
   # Start both backend and frontend
   ./scripts/start_servers.sh
   ```

2. **Manual startup**:
   
   Terminal 1 - Backend:
   ```bash
   cd backend
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   uvicorn main:app --reload --host 0.0.0.0 --port 8000
   ```
   
   Terminal 2 - Frontend:
   ```bash
   cd frontend
   npm run dev
   ```

3. **Access the application**:
   - Frontend: http://localhost:3000
   - Backend API: http://localhost:8000
   - API Docs: http://localhost:8000/docs

### Verify Installation

1. **Check backend health**:
   ```bash
   curl http://localhost:8000/health
   # Should return: {"status":"healthy"}
   ```

2. **Check frontend**:
   - Open http://localhost:3000
   - You should see the InventorySync dashboard
   - Red "Development Mode" banner should be visible

3. **Test API endpoints**:
   ```bash
   # Get custom field templates
   curl http://localhost:8000/api/custom-fields/templates
   ```

## üîê Authentication Configuration

### Development Mode Authentication

The app includes automatic authentication for development:

1. **Auto-Authentication**: When running locally, the app automatically authenticates with a test shop domain
2. **Test Shop Domain**: `inventorysync-dev.myshopify.com`
3. **Development Token**: Generated automatically

### Recent Authentication Fixes

- ‚úÖ Fixed shop domain resolution across components
- ‚úÖ Added development authentication helper (`frontend/src/utils/devAuth.js`)
- ‚úÖ Implemented auto-login for localhost environment
- ‚úÖ Added localStorage fallbacks for shop domain

### Production Authentication Setup

1. **Configure JWT Settings**
```env
# backend/.env
SECRET_KEY=your-256-bit-secret-key
JWT_SECRET_KEY=your-jwt-secret-key
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=30
```

2. **Generate Secure Keys**
```bash
# Generate secret keys
python generate_secrets.py
```

3. **Shopify OAuth Configuration**
```env
SHOPIFY_API_KEY=your-shopify-api-key
SHOPIFY_API_SECRET=your-shopify-api-secret
SHOPIFY_WEBHOOK_SECRET=your-webhook-secret
```

### Authentication Flow

1. Shop installs app via Shopify App Store
2. OAuth redirect to your app URL
3. App validates OAuth request
4. Creates/updates store record in database
5. Generates JWT access token
6. Returns token to frontend
7. Frontend stores token in localStorage
8. All API requests include JWT in headers

## Configuration

### Backend Environment Variables

The backend `.env` file is already configured for development. For production, update:

```env
# Shopify App Credentials
SHOPIFY_API_KEY=your_production_api_key
SHOPIFY_API_SECRET=your_production_api_secret
SHOPIFY_WEBHOOK_SECRET=generate_webhook_secret

# Database
DATABASE_URL=postgresql://user:password@host:5432/dbname

# Security
SECRET_KEY=generate-strong-256-bit-key

# Optional Services
REDIS_URL=redis://localhost:6379/0
SENTRY_DSN=your-sentry-dsn
```

### Frontend Configuration

Frontend uses Vite proxy for development. For production, configure:

```javascript
// vite.config.js - already configured for development
export default {
  server: {
    proxy: {
      '/api': 'http://localhost:8000'
    }
  }
}
```

## üìÅ Project Structure

```
inventorysync-shopify-app/
‚îú‚îÄ‚îÄ backend/                    # FastAPI Backend Application
‚îÇ   ‚îú‚îÄ‚îÄ api/                   # API Route Handlers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py           # Authentication endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory.py      # Inventory management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ custom_fields.py  # Custom fields API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard.py      # Analytics & statistics
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ alerts.py         # Alert management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ shopify_sync.py   # Shopify synchronization
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ webhooks.py       # Webhook handlers
‚îÇ   ‚îú‚îÄ‚îÄ core/                  # Core Application Logic
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security.py       # JWT & authentication
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ permissions.py    # RBAC implementation
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ exceptions.py     # Custom exceptions
‚îÇ   ‚îú‚îÄ‚îÄ models/               # Database Models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ store.py         # Store model
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ product.py       # Product model
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory.py     # Inventory model
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ custom_field.py  # Custom field models
‚îÇ   ‚îú‚îÄ‚îÄ schemas/              # Pydantic Schemas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ store.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ product.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ custom_field.py
‚îÇ   ‚îú‚îÄ‚îÄ services/             # Business Logic Services
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ shopify.py       # Shopify API client
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory.py     # Inventory service
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ forecasting.py   # ML forecasting
‚îÇ   ‚îú‚îÄ‚îÄ utils/                # Utility Functions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cache.py         # Redis caching
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logger.py        # Logging configuration
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validators.py    # Input validators
‚îÇ   ‚îú‚îÄ‚îÄ alembic/             # Database Migrations
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ versions/        # Migration files
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ alembic.ini      # Alembic config
‚îÇ   ‚îú‚îÄ‚îÄ tests/               # Test Suite
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ unit/           # Unit tests
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ integration/    # Integration tests
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ conftest.py     # Test fixtures
‚îÇ   ‚îú‚îÄ‚îÄ scripts/             # Utility Scripts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ init_db.py      # Database initialization
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ seed_data.py    # Seed test data
‚îÇ   ‚îú‚îÄ‚îÄ .env                 # Environment variables
‚îÇ   ‚îú‚îÄ‚îÄ .env.example         # Environment template
‚îÇ   ‚îú‚îÄ‚îÄ config.py            # Configuration management
‚îÇ   ‚îú‚îÄ‚îÄ database.py          # Database setup
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # FastAPI app entry
‚îÇ   ‚îú‚îÄ‚îÄ models.py            # Legacy models file
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt     # Python dependencies
‚îÇ
‚îú‚îÄ‚îÄ frontend/                 # React Frontend Application
‚îÇ   ‚îú‚îÄ‚îÄ public/              # Static Assets
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ favicon.ico
‚îÇ   ‚îú‚îÄ‚îÄ src/                 # Source Code
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/      # React Components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ common/     # Shared components
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Header.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Footer.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Loading.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/  # Dashboard components
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StatsCard.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Charts.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory/  # Inventory components
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Inventory.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProductList.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BulkActions.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ custom-fields/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CustomFieldsManager.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FieldForm.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ TemplateSelector.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ alerts/     # Alert components
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ AlertManager.jsx
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ RuleBuilder.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ context/        # React Context
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuthContext.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ShopContext.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ThemeContext.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/          # Custom Hooks
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAuth.js
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useShopify.js
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useApi.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/       # API Services
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.js      # Axios instance
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.js     # Auth service
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ inventory.js # Inventory service
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/          # Utility Functions
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ devAuth.js  # Dev authentication
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ helpers.js  # Helper functions
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ constants.js # App constants
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ styles/         # CSS/SCSS Files
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ globals.css
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.jsx         # Main App Component
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.css         # App styles
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.jsx        # React entry point
‚îÇ   ‚îú‚îÄ‚îÄ tests/              # Frontend Tests
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ unit/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ e2e/
‚îÇ   ‚îú‚îÄ‚îÄ .env                # Environment variables
‚îÇ   ‚îú‚îÄ‚îÄ .env.example        # Environment template
‚îÇ   ‚îú‚îÄ‚îÄ .gitignore          # Git ignore file
‚îÇ   ‚îú‚îÄ‚îÄ package.json        # NPM dependencies
‚îÇ   ‚îú‚îÄ‚îÄ package-lock.json   # Dependency lock
‚îÇ   ‚îú‚îÄ‚îÄ vite.config.js      # Vite configuration
‚îÇ   ‚îî‚îÄ‚îÄ README.md           # Frontend readme
‚îÇ
‚îú‚îÄ‚îÄ docs/                    # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ api/                # API documentation
‚îÇ   ‚îú‚îÄ‚îÄ deployment/         # Deployment guides
‚îÇ   ‚îî‚îÄ‚îÄ development/        # Development guides
‚îÇ
‚îú‚îÄ‚îÄ scripts/                 # Project Scripts
‚îÇ   ‚îú‚îÄ‚îÄ start_backend.sh    # Start backend server
‚îÇ   ‚îú‚îÄ‚îÄ start_frontend.sh   # Start frontend dev
‚îÇ   ‚îú‚îÄ‚îÄ start_servers.sh    # Start both servers
‚îÇ   ‚îî‚îÄ‚îÄ generate_secrets.py # Generate secret keys
‚îÇ
‚îú‚îÄ‚îÄ monitoring/              # Monitoring Config
‚îÇ   ‚îú‚îÄ‚îÄ prometheus.yml      # Prometheus config
‚îÇ   ‚îî‚îÄ‚îÄ grafana/           # Grafana dashboards
‚îÇ
‚îú‚îÄ‚îÄ .github/                # GitHub Configuration
‚îÇ   ‚îî‚îÄ‚îÄ workflows/         # GitHub Actions
‚îÇ       ‚îú‚îÄ‚îÄ ci.yml         # CI pipeline
‚îÇ       ‚îî‚îÄ‚îÄ deploy.yml     # Deploy pipeline
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml      # Docker Compose config
‚îú‚îÄ‚îÄ Dockerfile.backend      # Backend Dockerfile
‚îú‚îÄ‚îÄ Dockerfile.frontend     # Frontend Dockerfile
‚îú‚îÄ‚îÄ .env.example           # Root environment template
‚îú‚îÄ‚îÄ .gitignore             # Git ignore file
‚îú‚îÄ‚îÄ LICENSE                # MIT License
‚îú‚îÄ‚îÄ README.md              # This file
‚îî‚îÄ‚îÄ PROJECT_STATUS.md      # Current project status
```

## üè∑Ô∏è Custom Fields API

The Custom Fields API provides flexible product metadata management with industry-specific templates.

### Features
- **Industry Templates**: Pre-built field sets for different business types
- **Field Types**: text, number, date, select, boolean, json
- **Validation Rules**: Min/max values, regex patterns, required fields
- **Bulk Operations**: Apply fields to multiple products efficiently

### Available Templates

**Apparel Industry:**
- Size (select: XS, S, M, L, XL, XXL)
- Color (text)
- Material (text)
- Season (select: Spring, Summer, Fall, Winter)

**Electronics:**
- Warranty Period (number - months)
- Technical Specifications (json)
- Compatibility (text)

**Food & Beverage:**
- Expiration Date (date)
- Batch Number (text)
- Storage Temperature (number - ¬∞C)
- Ingredients (text)

### API Endpoints

```http
# Get all available templates
GET /api/custom-fields/templates

# Create a custom field
POST /api/custom-fields/{shop_domain}
Content-Type: application/json
{
  "field_name": "size",
  "field_type": "select",
  "display_name": "Size",
  "required": true,
  "options": ["S", "M", "L", "XL"]
}

# List all custom fields for a store
GET /api/custom-fields/{shop_domain}

# Update custom field
PUT /api/custom-fields/{shop_domain}/{field_id}

# Delete custom field
DELETE /api/custom-fields/{shop_domain}/{field_id}

# Apply custom field to products
POST /api/custom-fields/{shop_domain}/apply
{
  "field_id": 123,
  "product_ids": [456, 789],
  "value": "Large"
}
```

### Usage Example

```javascript
// Frontend: Create a custom field
const response = await fetch('/api/custom-fields/mystore.myshopify.com', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${token}`
  },
  body: JSON.stringify({
    field_name: 'warranty_months',
    field_type: 'number',
    display_name: 'Warranty (Months)',
    required: true,
    validation_rules: {
      min: 0,
      max: 60
    }
  })
});
```

## üìÅ Project Structure

### Interactive Documentation
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

### Key API Endpoints

```
# Inventory Management
GET    /api/v1/inventory/products
POST   /api/v1/inventory/sync
PUT    /api/v1/inventory/bulk-update

# Custom Fields
GET    /api/v1/custom-fields/{shop_domain}
POST   /api/v1/custom-fields/{shop_domain}
GET    /api/v1/custom-fields/templates

# Analytics
GET    /api/v1/dashboard/stats/{shop_domain}
GET    /api/v1/dashboard/charts/{shop_domain}

# Alerts
GET    /api/v1/alerts/{shop_domain}
POST   /api/v1/alerts/rules/{shop_domain}
```

## Testing

### Backend Tests
```bash
cd backend
pytest tests/ -v
```

### Frontend Tests
```bash
cd frontend
npm test
```

### E2E Tests
```bash
npm run test:e2e
```

## Deployment

### Docker Deployment

```bash
# Build and run with Docker Compose
docker-compose up -d

# View logs
docker-compose logs -f
```

### Production Checklist

- [ ] Update all environment variables
- [ ] Enable HTTPS (required by Shopify)
- [ ] Configure domain and SSL certificates
- [ ] Set up database backups
- [ ] Configure monitoring (Sentry, etc.)
- [ ] Enable rate limiting
- [ ] Set up GDPR webhooks
- [ ] Configure Shopify billing

## Shopify App Submission

### Requirements Checklist

- [ ] OAuth 2.0 implementation
- [ ] Webhook handlers for app/uninstalled
- [ ] GDPR compliance webhooks
- [ ] Billing API integration
- [ ] App Bridge for embedded experience
- [ ] Polaris design compliance
- [ ] Performance requirements (<3s load time)
- [ ] Security review passed

### Testing on Development Store

1. Create a development store at partners.shopify.com
2. Install ngrok: `npm install -g ngrok`
3. Expose local server: `ngrok http 8000`
4. Update app URLs in Partner Dashboard
5. Install app on development store

## üîß Troubleshooting

### Common Issues and Solutions

#### Frontend Connection Issues

**Problem**: Frontend can't connect to backend API
```
Failed to fetch
net::ERR_CONNECTION_REFUSED
```

**Solutions**:
1. Verify backend is running:
   ```bash
   # Check if backend is running
   curl http://localhost:8000/health
   ```
2. Check Vite proxy configuration in `vite.config.js`
3. Clear browser cache and cookies
4. Ensure CORS is properly configured in backend

#### Authentication Issues

**Problem**: "No shop domain found" error

**Solutions**:
1. Clear localStorage:
   ```javascript
   localStorage.clear()
   window.location.reload()
   ```
2. Check if running in development mode (should see red banner)
3. Manually set shop domain:
   ```javascript
   localStorage.setItem('shopDomain', 'inventorysync-dev.myshopify.com')
   ```

#### Database Connection Errors

**Problem**: SQLAlchemy connection error
```
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError)
```

**Solutions**:
1. Verify PostgreSQL service:
   ```bash
   # Linux/macOS
   sudo systemctl status postgresql
   # or
   brew services list | grep postgresql
   ```
2. Check database exists:
   ```bash
   psql -U postgres -l | grep inventorysync_dev
   ```
3. Verify credentials in `.env`:
   ```env
   DATABASE_URL=postgresql://inventorysync:devpassword123@localhost:5432/inventorysync_dev
   ```
4. Test connection:
   ```bash
   psql -U inventorysync -d inventorysync_dev -h localhost
   ```

#### Import/Module Errors

**Problem**: Module not found or import errors
```
Module not found: Error: Can't resolve '@shopify/polaris'
```

**Solutions**:
1. Clear Vite cache:
   ```bash
   rm -rf node_modules/.vite
   rm -rf node_modules
   npm install
   ```
2. Check for case sensitivity issues (especially on Linux)
3. Verify all dependencies are installed:
   ```bash
   npm list @shopify/polaris
   ```

#### Port Already in Use

**Problem**: Port 8000 or 3000 already in use

**Solutions**:
1. Find process using port:
   ```bash
   # Linux/macOS
   lsof -i :8000
   # Windows
   netstat -ano | findstr :8000
   ```
2. Kill the process:
   ```bash
   # Linux/macOS
   kill -9 <pid>
   # Windows
   taskkill /PID <pid> /F
   ```
3. Or use different ports:
   ```bash
   # Backend
   uvicorn main:app --port 8001
   # Frontend - update vite.config.js proxy
   ```

#### Shopify API Errors

**Problem**: 401 Unauthorized from Shopify

**Solutions**:
1. Verify Shopify credentials in `.env`
2. Check if access token is expired
3. Ensure shop domain is correct
4. For development, use test credentials:
   ```env
   SHOPIFY_API_KEY=test_api_key
   SHOPIFY_API_SECRET=test_api_secret
   ```

#### Custom Fields Not Saving

**Problem**: Custom fields created but not persisting

**Solutions**:
1. Check database migrations:
   ```bash
   alembic current
   alembic upgrade head
   ```
2. Verify table exists:
   ```sql
   SELECT * FROM custom_field_definitions LIMIT 1;
   ```
3. Check API response for errors
4. Ensure proper authentication token

#### Performance Issues

**Problem**: Slow page loads or API responses

**Solutions**:
1. Enable Redis caching:
   ```bash
   redis-server
   ```
2. Check for N+1 query problems
3. Enable database query logging:
   ```python
   # In config.py
   SQLALCHEMY_ECHO = True
   ```
4. Use Chrome DevTools Performance tab

### Development Environment Reset

If all else fails, perform a complete reset:

```bash
# Stop all services
pkill -f uvicorn
pkill -f "npm run dev"

# Clear all caches
rm -rf frontend/node_modules/.vite
rm -rf backend/__pycache__
rm -rf backend/.pytest_cache

# Reset database
dropdb inventorysync_dev
createdb inventorysync_dev
cd backend && alembic upgrade head

# Reinstall dependencies
cd backend && pip install -r requirements.txt
cd ../frontend && npm ci

# Start fresh
./scripts/start_servers.sh
```

### Getting Help

If you're still experiencing issues:

1. Check the logs:
   - Backend: Look for errors in terminal running uvicorn
   - Frontend: Check browser console (F12)
   - Database: Check PostgreSQL logs

2. Enable debug mode:
   ```env
   # backend/.env
   DEBUG=True
   LOG_LEVEL=DEBUG
   ```

3. Create an issue with:
   - Error message/screenshot
   - Steps to reproduce
   - Environment details (OS, Python version, Node version)
   - Relevant log files

## Contributing

1. Fork the repository
2. Create feature branch (`git checkout -b feature/amazing-feature`)
3. Follow code style (Black for Python, ESLint for JS)
4. Write tests for new features
5. Commit changes (`git commit -m 'Add amazing feature'`)
6. Push to branch (`git push origin feature/amazing-feature`)
7. Open Pull Request

## License

This project is licensed under the MIT License - see [LICENSE](LICENSE) file.

## Support

- üìß Email: support@inventorysync.com
- üí¨ Discord: [Join our community](https://discord.gg/inventorysync)
- üìñ Docs: [docs.inventorysync.com](https://docs.inventorysync.com)
- üêõ Issues: [GitHub Issues](https://github.com/yourusername/inventorysync-shopify-app/issues)

---

**Note**: This is a development version. For production deployment, please follow the security checklist and update all credentials.
